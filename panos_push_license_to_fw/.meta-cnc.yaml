name: push_license_files_to_fw
label: Push License Key to FW
description: |
    Push license keys to NGFW

type: panos

labels:
  collection: lib

variables:
  - name: TARGET_IP
    description: NGFW IP or Hostname
    default: 192.168.55.10
    type_hint: hidden
  - name: TARGET_USERNAME
    description: NGFW Username
    default: admin
    type_hint: hidden
  - name: TARGET_PASSWORD
    description: NGFW Password
    default: admin
    type_hint: hidden
  - name: key_list
    type_hint: hidden

snippets:
  - name: format_cli_command
    cmd: parse
    variable: key_list
    outputs:
      - name: push_command
        capture_variable: 'request license install {{ key_list|join(" ") }}'

  - name: push_command_to_fw
    cmd: cli
    cmd_str: request license install {{ push_command }}